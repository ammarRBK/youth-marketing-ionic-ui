{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/UNICEF/Desktop/youth-marketing-projrct/youth-marketing-ionic-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { __decorate } from \"tslib\";\nimport { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { throwError } from 'rxjs';\nimport { retry, catchError } from 'rxjs/operators';\nimport { Device } from '@awesome-cordova-plugins/device/ngx';\nimport { FileTransfer } from '@awesome-cordova-plugins/file-transfer/ngx';\nimport { LoadingController } from '@ionic/angular';\nlet ProductsService = (_class = class ProductsService {\n  constructor(http, device, transferer, loadingController) {\n    this.http = http;\n    this.device = device;\n    this.transferer = transferer;\n    this.loadingController = loadingController;\n    this.deviceId = this.device.uuid;\n    this.url = 'https://marketing-server.onrender.com/api/';\n    this.httpOptions = {\n      headers: new HttpHeaders({\n        'Access-Control-Allow-Origin': '*',\n        'Content-Type': 'application/json'\n      })\n    };\n    this.product = {\n      productinfo: {},\n      permited: false\n    };\n    this.status = \"\";\n    this.productCategories = [\"مواد غذائية صنع معمل\", \"حلويات صنع معمل\", \"حلويات صنع منزلي\", \"مواد غذائية صنع منزلي\", \"ملابس\", \"حرف يدوية\", \"صوف\", \"أدوات منزلية\"];\n  }\n  addProduct(imageUri, productData) {\n    productData.params.deviceId = this.deviceId;\n    const filetransfer = this.transferer.create();\n    return filetransfer.upload(imageUri, encodeURI(this.url + \"products/addproduct\"), productData);\n    // this.http.post(this.url+\"products/addproduct\",productData,this.httpOptions).pipe(\n    //   retry(2),\n    //   catchError(this.handleError)\n    // )\n  }\n\n  editProduct(newProductData) {\n    return this.http.post(this.url + \"products/editproduct\", newProductData, this.httpOptions).pipe(retry(2), catchError(this.handleError));\n  }\n  editProductImage(imageUri, imageData) {\n    const filetransfer = this.transferer.create();\n    return filetransfer.upload(imageUri, encodeURI(this.url + \"products/editimageproduct\"), imageData);\n  }\n  getProducts() {\n    return this.http.get(this.url + \"products/getproducts\", this.httpOptions).pipe(retry(2), catchError(this.handleError));\n  }\n  getUserProducts() {\n    return this.http.post(this.url + \"products/getUserProducts\", {\n      deviceId: this.deviceId\n    }, this.httpOptions).pipe(retry(2), catchError(this.handleError));\n  }\n  deleteProduct(product) {\n    return this.http.post(this.url + 'products/deleteproduct', product, this.httpOptions).pipe(retry(2), catchError(this.handleError));\n  }\n  get productData() {\n    return this.product.productinfo;\n  }\n  set productData(product) {\n    this.product['productinfo'] = product;\n  }\n  loadingProcess(message) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const loader = yield _this.loadingController.create({\n        spinner: 'circular',\n        message: message,\n        mode: 'ios',\n        backdropDismiss: true,\n        animated: true,\n        keyboardClose: true\n      });\n      yield loader.present();\n    })();\n  }\n  // set updateUserProducts(productId){\n  // }\n  // get updateUserProducts(){\n  //   return this.getUserProducts().subscribe(res=>{\n  //     res['message'] !== \"you dont have products yet\" ? JSON.parse(res['prods']) : \"\";\n  //   })\n  // }\n  handleError(error) {\n    if (error.status === 0) {\n      // A client-side or network error occurred. Handle it accordingly.\n      console.error('An error occurred:', error.error);\n    } else {\n      // The backend returned an unsuccessful response code.\n      // The response body may contain clues as to what went wrong.\n      console.error(`Backend returned code ${error.status}, body was: `, error.error);\n    }\n    // Return an observable with a user-facing error message.\n    return throwError('Something bad happened; please try again later.');\n  }\n}, _class.ctorParameters = () => [{\n  type: HttpClient\n}, {\n  type: Device\n}, {\n  type: FileTransfer\n}, {\n  type: LoadingController\n}], _class);\nProductsService = __decorate([Injectable({\n  providedIn: 'root'\n})], ProductsService);\nexport { ProductsService };","map":{"version":3,"names":["Injectable","HttpClient","HttpHeaders","throwError","retry","catchError","Device","FileTransfer","LoadingController","ProductsService","_class","constructor","http","device","transferer","loadingController","deviceId","uuid","url","httpOptions","headers","product","productinfo","permited","status","productCategories","addProduct","imageUri","productData","params","filetransfer","create","upload","encodeURI","editProduct","newProductData","post","pipe","handleError","editProductImage","imageData","getProducts","get","getUserProducts","deleteProduct","loadingProcess","message","_this","_asyncToGenerator","loader","spinner","mode","backdropDismiss","animated","keyboardClose","present","error","console","__decorate","providedIn"],"sources":["C:\\Users\\UNICEF\\Desktop\\youth-marketing-projrct\\youth-marketing-ionic-ui\\src\\app\\services\\products.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpErrorResponse, HttpHeaders } from '@angular/common/http';\r\nimport { throwError, Observable } from 'rxjs';\r\nimport { retry, catchError } from 'rxjs/operators';\r\nimport { Device } from '@awesome-cordova-plugins/device/ngx';\r\nimport { FileTransfer, FileUploadOptions, FileTransferObject } from '@awesome-cordova-plugins/file-transfer/ngx';\r\nimport { LoadingController } from '@ionic/angular';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ProductsService {\r\n\r\n  constructor(private http: HttpClient, private device: Device, private transferer: FileTransfer, private loadingController: LoadingController) { }\r\n  deviceId= this.device.uuid;\r\n  url= 'https://marketing-server.onrender.com/api/';\r\n  httpOptions: object={\r\n    headers: new HttpHeaders({\r\n      'Access-Control-Allow-Origin':'*',\r\n      'Content-Type': 'application/json'\r\n    })\r\n  }\r\n\r\n  product: any={\r\n    productinfo: {},\r\n    permited: false\r\n  };\r\n  status=\"\";\r\n  productCategories=[\"مواد غذائية صنع معمل\",\r\n  \"حلويات صنع معمل\",\r\n  \"حلويات صنع منزلي\",\r\n  \"مواد غذائية صنع منزلي\" ,\r\n  \"ملابس\",\r\n  \"حرف يدوية\",\r\n  \"صوف\",\r\n  \"أدوات منزلية\"];\r\n\r\n  addProduct(imageUri, productData){\r\n    productData.params.deviceId= this.deviceId\r\n    const filetransfer: FileTransferObject= this.transferer.create();\r\n    return filetransfer.upload(imageUri, encodeURI(this.url+\"products/addproduct\"), productData)\r\n    // this.http.post(this.url+\"products/addproduct\",productData,this.httpOptions).pipe(\r\n    //   retry(2),\r\n    //   catchError(this.handleError)\r\n    // )\r\n  }\r\n\r\n  editProduct(newProductData){\r\n    return this.http.post(this.url+\"products/editproduct\", newProductData, this.httpOptions).pipe(\r\n      retry(2),\r\n      catchError(this.handleError)\r\n    )\r\n  }\r\n\r\n  editProductImage(imageUri, imageData){\r\n    const filetransfer: FileTransferObject= this.transferer.create();\r\n    return filetransfer.upload(imageUri, encodeURI(this.url+\"products/editimageproduct\"), imageData)\r\n  }\r\n\r\n  getProducts(){\r\n    return this.http.get(this.url+\"products/getproducts\",this.httpOptions).pipe(\r\n      retry(2),\r\n      catchError(this.handleError)\r\n    )\r\n  }\r\n\r\n  getUserProducts(){\r\n    return this.http.post(this.url+\"products/getUserProducts\",{deviceId:this.deviceId},this.httpOptions).pipe(\r\n      retry(2),\r\n      catchError(this.handleError)\r\n    )\r\n  }\r\n\r\n  deleteProduct(product){\r\n    return this.http.post(this.url+'products/deleteproduct',product,this.httpOptions).pipe(\r\n      retry(2),\r\n      catchError(this.handleError)\r\n    )\r\n  }\r\n\r\n  get productData():any{\r\n    return this.product.productinfo;\r\n  }\r\n\r\n  set productData(product:any){\r\n    this.product['productinfo']= product;\r\n  }\r\n\r\n  async loadingProcess(message:string){\r\n    const loader=await this.loadingController.create({\r\n      spinner: 'circular',\r\n      message: message,\r\n      mode: 'ios',\r\n      backdropDismiss: true,\r\n      animated: true,\r\n      keyboardClose: true\r\n    })\r\n    await loader.present();\r\n  }\r\n\r\n\r\n  // set updateUserProducts(productId){\r\n\r\n  // }\r\n\r\n  // get updateUserProducts(){\r\n  //   return this.getUserProducts().subscribe(res=>{\r\n  //     res['message'] !== \"you dont have products yet\" ? JSON.parse(res['prods']) : \"\";\r\n  //   })\r\n  // }\r\n\r\n  private handleError(error: HttpErrorResponse) {\r\n    if (error.status === 0) {\r\n      // A client-side or network error occurred. Handle it accordingly.\r\n      console.error('An error occurred:', error.error);\r\n    } else {\r\n      // The backend returned an unsuccessful response code.\r\n      // The response body may contain clues as to what went wrong.\r\n      console.error(\r\n        `Backend returned code ${error.status}, body was: `, error.error);\r\n    }\r\n    // Return an observable with a user-facing error message.\r\n    return throwError(\r\n      'Something bad happened; please try again later.');\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}